<section class="gh-canvas">
    <GhCanvasHeader class="gh-canvas-header break tablet members-header">
        <h2 class="gh-canvas-title" data-test-screen-title>Members Activity</h2>

        <div class="view-actions">
            <div class="view-actions-top-row">
                <MembersActivity::EventTypeFilter
                    @excludedEvents={{this.excludedEvents}}
                    @hideMemberOnlyEvents={{not this.member}}
                    @updateExcludedEvents={{this.updateExcludedEvents}} />
            </div>
        </div>
    </GhCanvasHeader>

    <div class="view-container">
        {{#if this.memberRecord}}
            <GhMemberDetails @member={{this.memberRecord}} />
        {{/if}}

        {{#let (members-event-fetcher filter=this.filter pageSize=50) as |eventsFetcher|}}
            <div class="gh-list-scrolling">
                {{#if eventsFetcher.data}}
                    <MembersActivity::Table @hideMemberColumn={{if this.member true}} @events={{eventsFetcher.data}} />

                    {{#unless (or eventsFetcher.isLoading eventsFetcher.hasReachedEnd)}}
                        <GhScrollTrigger @enter={{eventsFetcher.loadNextPage}} @triggerOffset={{250}} />
                    {{/unless}}
                {{else unless eventsFetcher.isLoading}}
                    <MembersActivity::NoEvents @filter={{this.filter}} />
                {{/if}}

                {{#if eventsFetcher.isLoading}}
                    <div class="h30 flex flex-column items-center justify-center">
                        <div class="gh-loading-spinner"></div>
                    </div>
                {{/if}}
            </div>
        {{/let}}
    </div>
</section>

{{outlet}}